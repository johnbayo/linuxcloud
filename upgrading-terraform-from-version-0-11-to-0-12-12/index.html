<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>terraform, upgrade</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css">

    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="http://localhost:8080/upgrading-terraform-from-version-0-11-to-0-12-12/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="http://localhost:8080/upgrading-terraform-from-version-0-11-to-0-12-12/amp/">
    
    <meta property="og:site_name" content="linuxcloud.ng">
    <meta property="og:type" content="article">
    <meta property="og:title" content="terraform, upgrade">
    <meta property="og:description" content="As at the time of this post, the latest version of Terraform is the 0.12.12. The upgrade can be easily achieved with the following steps  Download the latest release of Terraform the link https://releases.hashicorp.com/terraform/  It can be installed from the linux command line by">
    <meta property="og:url" content="http://localhost:8080/upgrading-terraform-from-version-0-11-to-0-12-12/">
    <meta property="article:published_time" content="2019-10-23T13:50:26.000Z">
    <meta property="article:modified_time" content="2019-10-23T13:59:39.000Z">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="Howto">
    <meta property="article:tag" content="General">
    
    <meta property="article:publisher" content="https://www.facebook.com/linuxcloudng">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="terraform, upgrade">
    <meta name="twitter:description" content="As at the time of this post, the latest version of Terraform is the 0.12.12. The upgrade can be easily achieved with the following steps  Download the latest release of Terraform the link https://releases.hashicorp.com/terraform/  It can be installed from the linux command line by">
    <meta name="twitter:url" content="http://localhost:8080/upgrading-terraform-from-version-0-11-to-0-12-12/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="John Adebayo">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Linux, Howto, General">
    <meta name="twitter:site" content="@linuxcloudng">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "linuxcloud.ng",
        "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:8080/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "John Adebayo",
        "url": "http://localhost:8080/author/adebayo/",
        "sameAs": []
    },
    "headline": "terraform, upgrade",
    "url": "http://localhost:8080/upgrading-terraform-from-version-0-11-to-0-12-12/",
    "datePublished": "2019-10-23T13:50:26.000Z",
    "dateModified": "2019-10-23T13:59:39.000Z",
    "keywords": "Linux, Howto, General",
    "description": "As at the time of this post, the latest version of Terraform is the 0.12.12. The\nupgrade can be easily achieved with the following steps\n\nDownload the latest release of Terraform the link \nhttps://releases.hashicorp.com/terraform/\n\nIt can be installed from the linux command line by simply writing the command\nbelow\n\nwget https://releases.hashicorp.com/terraform/0.12.12/terraform_0.12.12_linux_amd64.zip -O /tmp/terraform_0.12.12_linux_amd64.zip; sudo unzip /tmp/terraform_0.12.12_linux_amd64.zip -d",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:8080/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.2">
    <link rel="alternate" type="application/rss+xml" title="linuxcloud.ng" href="http://localhost:8080/rss/">
    <!-- Fix first paragraph font size -->
<style type="text/css">
 .post-template .kg-card-markdown > p:first-child {font-size: 0.8em;}
 .post-full-content pre {
    font-size: 1.4rem;
}
</style>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-146783831-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-146783831-1');
</script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

</head>
<body class="post-template tag-linux tag-howto tag-general">

    <div class="site-wrapper">

        

<header class="site-header">
    <div class="outer site-nav-main">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left-wrapper">
        <div class="site-nav-left">
                <a class="site-nav-logo" href="../">linuxcloud.ng</a>
            <div class="site-nav-content">
                    <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="http://172.168.11.62/">Home</a></li>
    <li class="nav-general" role="menuitem"><a href="http://172.168.11.62/tag/general/">General</a></li>
    <li class="nav-linux" role="menuitem"><a href="http://172.168.11.62/tag/linux/">Linux</a></li>
    <li class="nav-aws" role="menuitem"><a href="http://172.168.11.62/tag/aws/">AWS</a></li>
    <li class="nav-azure" role="menuitem"><a href="http://172.168.11.62/tag/azure/">Azure</a></li>
    <li class="nav-database" role="menuitem"><a href="http://172.168.11.62/tag/database/">Database</a></li>
    <li class="nav-howto" role="menuitem"><a href="http://172.168.11.62/tag/howto/">Howto</a></li>
</ul>

                    <span class="nav-post-title dash">Upgrading Terraform from version 0.11.x to 0.12.12 with both a local State File or Remote State</span>
            </div>
        </div>
    </div>
    <div class="site-nav-right">
            <div class="social-links">
                    <a class="social-link social-link-fb" href="https://www.facebook.com/linuxcloudng" title="Facebook" target="_blank" rel="noopener"><svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M16 0c8.837 0 16 7.163 16 16s-7.163 16-16 16S0 24.837 0 16 7.163 0 16 0zm5.204 4.911h-3.546c-2.103 0-4.443.885-4.443 3.934.01 1.062 0 2.08 0 3.225h-2.433v3.872h2.509v11.147h4.61v-11.22h3.042l.275-3.81h-3.397s.007-1.695 0-2.187c0-1.205 1.253-1.136 1.329-1.136h2.054V4.911z"/></svg></a>
                    <a class="social-link social-link-tw" href="https://twitter.com/linuxcloudng" title="Twitter" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
            </div>
                <a class="rss-button" href="https://feedly.com/i/subscription/feed/http://localhost:8080/rss/" title="RSS" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
</a>

    </div>
</nav>
    </div>
</div></header>


<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post tag-linux tag-howto tag-general no-image no-image">

            <header class="post-full-header">

                <section class="post-full-tags">
                    <a href="../tag/linux/">Linux</a>
                </section>

                <h1 class="post-full-title">Upgrading Terraform from version 0.11.x to 0.12.12 with both a local State File or Remote State</h1>


                <div class="post-full-byline">

                    <section class="post-full-byline-content">

                        <ul class="author-list">
                            <li class="author-list-item">

                                <div class="author-card">
                                    <div class="author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg>
</div>
                                    <div class="author-info">
                                        <h2>John Adebayo</h2>
                                        <p>Read <a href="../author/adebayo/">more posts</a> by this author.</p>
                                    </div>
                                </div>

                                <a href="../author/adebayo/" class="author-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg>
</a>

                            </li>
                        </ul>

                        <section class="post-full-byline-meta">
                            <h4 class="author-name"><a href="../author/adebayo/">John Adebayo</a></h4>
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2019-10-23">23 Oct 2019</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> 2 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>


            <section class="post-full-content">
                <div class="post-content">
                    <!--kg-card-begin: markdown--><p>As at the time of this post, the latest version of Terraform is the 0.12.12. The upgrade can be easily achieved with the following steps</p>
<p>Download the latest release of Terraform the link <a href="https://releases.hashicorp.com/terraform/">https://releases.hashicorp.com/terraform/</a></p>
<p>It can be installed from the linux command line by simply writing the command below</p>
<pre><code>wget https://releases.hashicorp.com/terraform/0.12.12/terraform_0.12.12_linux_amd64.zip -O /tmp/terraform_0.12.12_linux_amd64.zip; sudo unzip /tmp/terraform_0.12.12_linux_amd64.zip -d /usr/local/bin/
terraform version
Terraform v0.12.12
</code></pre>
<p>If your remote state lies in a backend simply intialize terraform once again with your backend</p>
<pre><code>terraform init -backend-config=credentials.auto.tfvars
</code></pre>
<p>while locally can be simply typing</p>
<pre><code>terraform init
</code></pre>
<p>Terraform added a tool which simply upgrades all your terraform tf or .auto.tfvars file. This can be then initialized and rewrites your state files by simply typing the command below</p>
<pre><code>terraform 0.12upgrade
This command will rewrite the configuration files in the given directory so
that they use the new syntax features from Terraform v0.12, and will identify
any constructs that may need to be adjusted for correct operation with
Terraform v0.12.

We recommend using this command in a clean version control work tree, so that
you can easily see the proposed changes as a diff against the latest commit.
If you have uncommited changes already present, we recommend aborting this
command and dealing with them before running this command again.

Would you like to upgrade the module in the current directory?
  Only 'yes' will be accepted to confirm.

  Enter a value: yes

-----------------------------------------------------------------------------

Upgrade complete!

The configuration files were upgraded successfully. Use your version control
system to review the proposed changes, make any necessary adjustments, and
then commit.
</code></pre>
<p>There you are good to go and continue working with the latest Terraform version at the time of this post.</p>
<p><em><strong>OBSERVATION</strong></em></p>
<p>Terraform not only rewrites all your files but as well creates a new file called versions.tf. The content shows your current terraform version.</p>
<pre><code>[xxxx@ terraform]$ cat versions.tf
terraform {
  required_version = &quot;&gt;= 0.12&quot;
}
</code></pre>
<p>Also observed in the 0.12 upgrade. Terraform inserts a TODO if its not sure of how to rewrite a part of a template. In my case was</p>
<pre><code># TF-UPGRADE-TODO: In Terraform v0.10 and earlier, it was sometimes necessary to
# force an interpolation expression to be interpreted as a list by wrapping it
# in an extra set of list brackets. That form was supported for compatibility in
# v0.11, but is no longer supported in Terraform v0.12.
#
# If the expression in the following list itself returns a list, remove the
# brackets to avoid interpretation as a list of lists. If the expression
# returns a single list item then leave it as-is and remove this TODO comment.
  records = [var.local_dns_ip[count.index]]
</code></pre>
<p>in my values, i had a list in list. so terraform wasn't sure how to interprete this. here is an example shown below</p>
<pre><code>local_dns_ip = [[&quot;192.168.200.199&quot;], [&quot;192.168.200.189&quot;], [&quot;192.168.200.169&quot;, &quot;92.168.200.179&quot;]
</code></pre>
<p>the variable representation was</p>
<pre><code>variable &quot;local_dns_ip&quot; {
  description = &quot;just an example&quot;
  type        = &quot;list&quot;
}
</code></pre>
<p>terraform 0.12upgrade rewrote my vars as shown below with the above error message</p>
<pre><code>variable &quot;local_dns_ip&quot; {
  description = &quot;just an example&quot;
  type        = list(string)
}
</code></pre>
<p>The solution was to simply to edit the vars and the records line as shown below</p>
<pre><code>#version 0.11.14
records = [var.local_dns_ip[count.index]]

#version 0.12.12
records = var.local_dns_ip[count.index]

#version 0.11.14
variable &quot;local_dns_ip&quot; {
  description = &quot;just an example&quot;
  type        = list(string)
}  

#version 0.12.12
variable &quot;local_dns_ip&quot; {
  description = &quot;just an example&quot;
  type        = list
}</code></pre>
<!--kg-card-end: markdown-->
                </div>
            </section>



        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
                <article class="read-next-card">
                    <header class="read-next-card-header">
                        <h3><span>More in</span> <a href="../tag/linux/">Linux</a></h3>
                    </header>
                    <div class="read-next-card-content">
                        <ul>
                            <li>
                                <h4><a href="../encode-and-decode-base64-bash/">encode and decode base64 Bash</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="2019-12-19">19 Dec 2019</time> –
                                        1 min read</p>
                                </div>
                            </li>
                            <li>
                                <h4><a href="../deploying-consul-and-vault-as-ha-in-kubernetes-part-1/">Deploying Consul and Vault as HA in Kubernetes (Part 2)</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="2019-11-29">29 Nov 2019</time> –
                                        5 min read</p>
                                </div>
                            </li>
                            <li>
                                <h4><a href="../deploying-consul-and-vault-as-ha-in-kubernetes/">Deploying Consul and Vault as HA in Kubernetes (Part 1)</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="2019-10-08">8 Oct 2019</time> –
                                        5 min read</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="../tag/linux/">See all 21 posts
                            →</a>
                    </footer>
                </article>

                <article class="post-card post tag-linux tag-howto tag-general no-image no-image">


    <div class="post-card-content">

        <a class="post-card-content-link" href="../deploying-consul-and-vault-as-ha-in-kubernetes-part-1/">

            <header class="post-card-header">
                    <div class="post-card-primary-tag">Linux</div>
                <h2 class="post-card-title">Deploying Consul and Vault as HA in Kubernetes (Part 2)</h2>
            </header>

            <section class="post-card-excerpt">
                    <p>Vault  what is vault?  Vault is an Harshicorp tool that is used for secrets management. By secrets management we mean it secures, stores, and tightly controls access to tokens, passwords, certificates, API keys, and any secrets of your choice. you can read more on</p>
            </section>

        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
            
                    <div class="author-name-tooltip">
                        John Adebayo
                    </div>
            
                    <a href="../author/adebayo/" class="static-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg>
</a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../author/adebayo/">John Adebayo</a></span>
                <span class="post-card-byline-date"><time datetime="2019-11-29">29 Nov 2019</time> <span class="bull">&bull;</span> 5 min read</span>
            </div>
        </footer>

    </div>

</article>

                <article class="post-card post tag-azure no-image no-image">


    <div class="post-card-content">

        <a class="post-card-content-link" href="../azure-security-groups/">

            <header class="post-card-header">
                    <div class="post-card-primary-tag">Azure</div>
                <h2 class="post-card-title">Brief Overview of Azure Resource Groups</h2>
            </header>

            <section class="post-card-excerpt">
                    <p>Resource groups is a container with all resources for an Azure solution. It helps in organizing resources and can be managed better with the help of it. resource groups have the following attributes as described below:  lifecycle: its best practice for resources in the</p>
            </section>

        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
            
                    <div class="author-name-tooltip">
                        John Adebayo
                    </div>
            
                    <a href="../author/adebayo/" class="static-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg>
</a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../author/adebayo/">John Adebayo</a></span>
                <span class="post-card-byline-date"><time datetime="2019-10-21">21 Oct 2019</time> <span class="bull">&bull;</span> 1 min read</span>
            </div>
        </footer>

    </div>

</article>
        </div>
    </div>
</aside>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="../">linuxcloud.ng</a> &copy; 2020</section>
                <nav class="site-footer-nav">
                    <a href="../">Latest Posts</a>
                    <a href="https://www.facebook.com/linuxcloudng" target="_blank" rel="noopener">Facebook</a>
                    <a href="https://twitter.com/linuxcloudng" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>


    <script src="https://code.jquery.com/jquery-3.4.1.min.js" crossorigin="anonymous">
    </script>
    <script src="../assets/built/casper.js"></script>

    <script>
        // Parse the URL parameter
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        // Give the parameter a variable name
        var action = getParameterByName('action');

        $(document).ready(function () {
            if (action == 'subscribe') {
                $('body').addClass("subscribe-success");
            }

            $('.subscribe-success-message .subscribe-close').click(function () {
                $('.subscribe-success-message').addClass('close');
            });

            // Reset form on opening subscrion overlay
            $('.subscribe-button').click(function() {
                $('.subscribe-overlay form').removeClass();
                $('.subscribe-email').val('');
            });
        });
    </script>

    <script>
    $(document).ready(function () {
        // FitVids - start
        var $postContent = $(".post-full-content");
        $postContent.fitVids();
        // FitVids - end

        // Replace nav with title on scroll - start
        Casper.stickyNavTitle({
            navSelector: '.site-nav-main',
            titleSelector: '.post-full-title',
            activeClass: 'nav-post-title-active'
        });
        // Replace nav with title on scroll - end

        // Hover on avatar
        var hoverTimeout;
        $('.author-list-item').hover(function () {
            var $this = $(this);

            clearTimeout(hoverTimeout);

            $('.author-card').removeClass('hovered');
            $(this).children('.author-card').addClass('hovered');

        }, function () {
            var $this = $(this);

            hoverTimeout = setTimeout(function () {
                $this.children('.author-card').removeClass('hovered');
            }, 800);
        });
    });
</script>


    <script id="dsq-count-scr" src="//linucloud-ng.disqus.com/count.js" async></script>

#<script data-ad-client="ca-pub-6562536909161389" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

</body>
</html>
